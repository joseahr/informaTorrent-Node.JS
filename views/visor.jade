extends map-layout
block script
	script(src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.1/js/bootstrap-datepicker.js")
	script(src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.5.1/locales/bootstrap-datepicker.es.min.js")
	//script(src="https://cdn.socket.io/socket.io-1.3.7.js")
	script.
		var dialog_;
		var denuncias = !{denuncias};
	
		var wktFormat = new ol.format.WKT({dataProjection: 'EPSG:4258'});
		
		map.addControl(new app.QueryDenuncias());
		
		num_denuncias_io.on('error_query', function(data){
			BootstrapDialog.show({ 
				title: 'Error consultando', 
				message: data.msg, 
				closable: true, 
				onshown: function(dialog){setTimeout(function(){dialog.close()}, 2000);}
			});
		});
		
		num_denuncias_io.on('new_denuncia', function(data){
			var denuncia = data.denuncia;
			console.log('denuncia a√±adida socket.io');
		
			vector.getSource().addFeature(wktFormat.readFeature(denuncia.wkt));
			
		});
		
	script(src="/javascripts/openlayers/olvisorapp.js")